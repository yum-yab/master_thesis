\ProvidesPackage{beamerthemeLeipzigChemie}[07/09/2021]
\usepackage{fontspec}
\setsansfont{Arial}

\usepackage{tikz}

\mode<presentation>

%%%%%%% Define color %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{DarkOrange}{RGB}{255, 152, 0}
\definecolor{granat}{RGB}{176, 47, 44}
\definecolor{karneol}{RGB}{214, 66, 66}
\definecolor{aquamarin}{RGB}{138, 194, 209}
\definecolor{hellgrau}{RGB}{201, 201, 201}
\definecolor{basalt}{RGB}{38, 42, 49}

%%%%%%%%%%%%%%%% Title page Layout %%%%%%%%%%%%%%%
\setbeamersize{sidebar width left=1mm, sidebar width right=1mm}

\newcommand{\titleHeaderLayout}
{
% trim={<left> <lower> <right> <upper>}
\includegraphics[trim={5em 0 0 4em},height=0.25\paperheight]{imglib/logo_leipzig.eps}
}

\makeatletter
\setbeamercolor{title}{fg=black}
\setbeamerfont{title}{size=\LARGE, series=\bfseries}
\setbeamerfont{institute}{size=\small,series=\mdseries}

\setbeamertemplate{title page}
{
    %\vspace{1mm}
    \titleHeaderLayout
    \begingroup
    \raggedright
    \begin{beamercolorbox}[center]{subtitle}
        \ifx\insertsubtitle\@empty%
        \else%
            \vskip.25em%
            {\Large \insertsubtitle\par}%
        \fi%  
    \end{beamercolorbox}%
    \vskip1em\par
    \begin{beamercolorbox}{title}
        \usebeamerfont{title}\inserttitle\par%
    \end{beamercolorbox}%
    \vskip1em\par
    \begin{beamercolorbox}{date}
      \usebeamerfont{date}\insertdate
    \end{beamercolorbox}
    \vskip0.1em
    \begin{beamercolorbox}{author}
      \usebeamerfont{author}\insertauthor
    \end{beamercolorbox}
    \vskip2em
    \begin{beamercolorbox}{institute}
      \usebeamerfont{institute}\insertinstitute
    \end{beamercolorbox}
  \endgroup
}

\newcommand{\GroupLogo}[1]{\addtobeamertemplate{title page}{
    \begin{tikzpicture}[remember picture, overlay]
        \node[anchor=south east] (image) at (10.5,-3.5){\includegraphics[height=0.2\textheight]{#1}};
    \end{tikzpicture}
}}

\makeatother

%%%%%%%%%%%%%%%%%% Header and Footer %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{navigation symbols}{}

%%%%%%% Footline background (not footer) %%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{background}{
{
    \begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
        \begin{scope}[x={(current page.north east)},y={(current page.south west)}]
        \draw[karneol, very thin] (0.068,0.88) -- (0.93,0.88);
        \draw[gray, very thin] (0.068,0.885) -- (0.93,0.885);
        
        \path[gray, thin]  (0.07,0.89) edge node[right, yshift=3pt] {\textcolor{black}{\tiny \textsf{UNIVERSIT\"AT}}} (0.07,.98);
        \path[gray]  (0.07,0.89) edge node[right, yshift=-3pt] {\textcolor{black}{\tiny \textsf{LEIPZIG}\hspace*{59.5em}}\textcolor{karneol}{\tiny \insertframenumber}} (0.07,.98);
        \end{scope}
    \end{tikzpicture}
}}
%%%%%%% Headline %%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{headline}{
	\begin{beamercolorbox}[wd=\paperwidth, ht=4mm]{title in head/foot}
		% gray and black line at the start
		\begin{tikzpicture}
			\draw [white](0,0)--(0.8,0); % Only to help position other lines
			\draw [gray, very thin](0,.08) -- (.8,.08);
			\draw [black, very thin] (0,.11) -- (.8,.11);
		\end{tikzpicture}
		\small \ \textbf{\insertshorttitle}\ | \insertsection
	\end{beamercolorbox}
	
}
%%%%%%% Frame title %%%%%%%%%%%%%%%
\setbeamertemplate{frametitle}{\vskip 10pt\color{black}\bfseries \insertframetitle\par \vskip 2pt}

%%%%%%%%%%%%%%%%%%%% Section page layout for 4/3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\specialpagelayout}
{\setbeamertemplate{background}{
    \begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
        \begin{scope}[x={(current page.north east)},y={(current page.south west)}]
        \draw[granat, fill=granat,thin] (0.65,0) -- (1,0) --  (1,1) -- cycle;
        \draw[aquamarin, fill=aquamarin, thin] (0.7,1) -- (1,1) --  (0.85,0.574) -- cycle;
        \draw[karneol,fill=karneol, thin] (0.85,0.574) -- (1,1) --  (1,0.1475) -- cycle;
        \draw[karneol, very thin] (0.068,0.88) -- (0.7,0.88);
        \draw[gray, very thin] (0.068,0.885) -- (0.7,0.885);
        \path[gray, thin]  (0.07,0.89) edge node[right, yshift=3pt] {\textcolor{black}{\tiny \textsf{UNIVERSIT\"AT}}} (0.07,.98);
        \path[gray]  (0.07,0.89) edge node[right, yshift=-3pt] {\textcolor{black}{\tiny \textsf{LEIPZIG}}} (0.07,.98);
        \end{scope}
    \end{tikzpicture}
}}

%%%%%%%%%%%%%%%%%%%% Section page layout for 16/9 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\SpecialPageLayout}
{\setbeamertemplate{background}{
    \begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
        \begin{scope}[x={(current page.north east)},y={(current page.south west)}]
        \draw[granat,fill=granat, thin] (0.6375,0) -- (0.9375,0) --  (0.788,0.575) -- cycle;
        \draw[aquamarin, fill=aquamarin, thin] (0.675,1) -- (0.9,1) --  (0.788,0.575) -- cycle;
        \draw[karneol, fill=karneol, thin] (0.9375,0) -- (1,0) --  (1,0.77) -- (0.9375,1) -- (0.9,1) -- (0.788,0.575) -- cycle;
        \draw[granat,fill=granat, thin] (0.9375,1) -- (1,1) --  (1,0.77) -- cycle;
        \draw[karneol, very thin] (0.068,0.88) -- (0.675,0.88);
        \draw[gray, very thin] (0.068,0.885) -- (0.675,0.885);
        \path[gray, thin]  (0.07,0.89) edge node[right, yshift=3pt] {\textcolor{black}{\tiny \textsf{UNIVERSIT\"AT}}} (0.07,.98);
        \path[gray]  (0.07,0.89) edge node[right, yshift=-3pt] {\textcolor{black}{\tiny \textsf{LEIPZIG}}} (0.07,.98);
        \end{scope}
    \end{tikzpicture}
}}

%%%%%%%%%%%%%%%%%% Create the sub-sub-sections number %%%%%%%%%%%%%%%%%%%%%%%%%%%
\defbeamertemplate{subsubsection in toc}{subsubsections numbered}
{\leavevmode\leftskip=3.5em%
 \rlap{\hskip-3.5em\inserttocsectionnumber.\inserttocsubsectionnumber.\inserttocsubsubsectionnumber}%
 \inserttocsubsubsection\par}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This is to create title page. The data are taken from TitlePageInfo.tex
\newcommand{\maketitlepage}{{
\setbeamertemplate{background}{    
    \begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
        \begin{scope}[x={(current page.north east)},y={(current page.south west)}]
        \draw[aquamarin,fill=aquamarin, thin] (0.65,1) -- (1,1) -- (1,0.65) -- cycle;
        \draw[karneol, fill=karneol, thin] (0.895,1) -- (1,1) -- (1,0.65) -- (0.925,0.725) -- cycle;
        \draw[granat, fill=granat,thin] (1,0.65) -- (0.925,0.725) -- (1,0) -- cycle;
        \end{scope}
    \end{tikzpicture}}
\setbeamertemplate{headline}{}
\begin{frame}
  \titlepage %
\end{frame}
}}

% Table of contents color and indentation
%-------- Many thanks to Victor JÃ¼ttner for this part -----------------------
\setbeamercolor{section in toc}{fg=granat}

\defbeamertemplate{section in toc}{mysections numbered}
{\leavevmode
	\parbox[t]{2em}{\inserttocsectionnumber.}
	\parbox[t]{.4\textwidth}{\inserttocsection}\par}
\setbeamertemplate{section in toc}[mysections numbered]

\defbeamertemplate{subsection in toc}{mysubsections numbered}
{\leavevmode
	\hspace{2em}
	\parbox[t]{2em}{\inserttocsectionnumber.\inserttocsubsectionnumber}
	\parbox[t]{.4\textwidth}{\inserttocsubsection}\par}
\setbeamertemplate{subsection in toc}[mysubsections numbered]

\defbeamertemplate{subsubsection in toc}{mysubsubsections numbered}
{\leavevmode
	\hspace{4em}
	\parbox[t]{3em}{\inserttocsectionnumber.\inserttocsubsectionnumber.\inserttocsubsubsectionnumber}
	\parbox[t]{.4\textwidth}{\inserttocsubsubsection}\par}
\setbeamertemplate{subsubsection in toc}[mysubsubsections numbered]
%--------------------------------------------------------------------------
%% This is to make table of contents/ overview slide after title page
\newcommand{\maketableofcontents}{
    {
    \SpecialPageLayout
    \begin{frame}{Outline}
        \tableofcontents
        \vspace*{3em}
    \end{frame}
   } 
}

%% This will show table of content slides before move to each subsection
\newcommand{\makesubsectionpopup}{
\AtBeginSubsection[]
{{
    \SpecialPageLayout
    \begin{frame}{Outline}
        \tableofcontents[currentsection,currentsubsection]
        \vspace*{3em}
    \end{frame}
}}
}

%%%%%%%%%%%%%%%%%%%%%%%%%% Re-position Footnote %%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{footnote}{%
    \raggedright\hspace*{9em}%{\insertfootnotemark}
    \parbox{30em}{$^{\text{\thefootnote}}$\scriptsize\insertfootnotetext}
}

\newcommand\addfootspace[1]{%
    \begingroup
        \renewcommand\thefootnote{}\footnote{#1}%
        \addtocounter{footnote}{-1}%
    \endgroup
}

%%%%%%%%%%% Switch off the footnoterule %%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\footnoterule}{}
%\renewcommand{\footnoterule}{\kern -20pt \hrule width \columnwidth \kern 25pt}

%%%%%%%%%%% Bibliograpy items as number %%%%%%%%%%%%%%%%%%%
\setbeamertemplate{bibliography item}{\insertbiblabel}

% Itemizesymbol
\setbeamercolor{itemize item}{fg=karneol}
\setbeamertemplate{itemize item}{--}
\setbeamercolor{itemize subitem}{fg=karneol}
\setbeamertemplate{itemize subitem}{--}
\setbeamercolor{itemize subsubitem}{fg=karneol}
\setbeamertemplate{itemize subsubitem}{--}
\setbeamercolor{enumerate item}{fg=karneol}
\setbeamercolor{enumerate subitem}{fg=karneol}
\setbeamercolor{enumerate subitem}{fg=karneol}

%%%%%%%%%%%%%%%%%%%% Captions %%%%%%%%%%%%%%%%%%%%%%
\setbeamercolor{caption name}{fg=black!50}
\setbeamertemplate{caption}[numbered]

%%%%%%%%%%%%%%%%%%%% Alert %%%%%%%%%%%%%%%%%%%
\setbeamercolor{alerted text}{fg=karneol}
\setbeamertemplate{blocks}[rounded][shadow=true]